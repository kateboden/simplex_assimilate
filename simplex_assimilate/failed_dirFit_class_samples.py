#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Fri Jul 12 15:28:11 2024

@author: kabo1917
"""

import numpy as np

# Here we explore the class samples that lead to failure in fitting dirichlet parameters

# The first 5 fails are for cases where logic was added in simple_class_transport to check if ensemble members were close

fail1 = np.array([[0.00288549, 0.27843026, 0.40392079, 0.28183569, 0.03292777],
 [0.00316413, 0.28734366, 0.4136824,  0.26667235, 0.02913737],
 [0.00259774, 0.27468269, 0.4014307,  0.28746919, 0.03381968],
 [0.00238964, 0.28058726, 0.40251491, 0.28034809, 0.03416011],
 [0.00263184, 0.28435671, 0.3999719,  0.27997105, 0.0330685 ]])

E = fail1.mean(axis = 0)
E2 = (fail1**2).mean(axis = 0)
Var = E2-E**2

fail2 = np.array([[0.00555054, 0.69940037, 0.29504909],
 [0.00618959, 0.71029581, 0.28351459]])

fail3 = np.array([[7.06356973e-03, 4.54447505e-05, 6.94303606e-01, 2.98587380e-01],
 [6.96037997e-03, 2.81136517e-05, 6.87530381e-01, 3.05481125e-01],
 [6.69688323e-03, 3.97722930e-05, 7.04856506e-01, 2.88406838e-01],
 [7.58716611e-03, 6.43073943e-05, 6.98706039e-01, 2.93642487e-01],
 [6.96026672e-03, 3.25586845e-05, 6.82843363e-01, 3.10163812e-01],
 [7.11092787e-03, 2.82521741e-05, 6.99341106e-01, 2.93519713e-01]])

fail4 = np.array([[1.11022302e-16, 6.06760637e-01, 3.93233917e-01, 5.44652106e-06],
 [1.11022302e-16, 6.22501684e-01, 3.77494347e-01, 3.96854888e-06]])

fail5 = np.array([[0.0084133,  0.21010613, 0.4800529,  0.26591945, 0.03550823],
                  [0.00867638, 0.22674755, 0.46816145, 0.26141451, 0.0350001]])


fail6 = np.array([[3.63164076e-03, 6.33279183e-01, 3.63088912e-01, 2.63812614e-07],
                  [3.10479365e-03, 6.30813536e-01, 3.66036515e-01, 4.51556338e-05],
                  [3.23212335e-03, 6.21205473e-01, 3.75541649e-01, 2.07549961e-05]])